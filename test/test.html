<html>
  <head>
    <title>Test page</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../nice.js"></script>
    <script src="https://unpkg.com/esprima@~4.0/dist/esprima.js"></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js"></script>-->
  </head>
  <body>
    <main id="js-main" class="main"></main>
<script>
"use strict";
const { Box, Div, Span, H1, H2, H3, B, I, A, next, Html, Img } = nice;
const { Arr, Type, Check, Mapping, Switch, is, 
   get, expect, Num, Str, Obj, _1, _2, _3 } = nice;
const spy = (...a) => console.log('Spy:', ...a);


const a = { then: (resolve) => setTimeout(() => resolve(2), 1) };
const b = new Promise((resolve) => setTimeout(() => resolve(3), 1));

var o = {
  get a(){
    return a;
  },
  get b(){
    return b;
  }
};

//(async function() {
////  var bar = new Foo();
////  bar.name = 'John'; // Since getters cannot take arguments
//  console.log(await o.a * o.b);
//})();

var AsyncFunction = Object.getPrototypeOf(async function(){}).constructor

var c = new AsyncFunction('a', 
                          'b', 
                          'return await a * await b');

c(b, a).then(v => {
  console.log(v); // prints 30 after 4 seconds
});


var p = new Proxy({}, {
      get: (o, k) => {
        console.log(k, ' accessed');
        return base.storage[value][base.pathId(k)];
      }
    })

//(async () => {
//    let p = new Proxy({ then: undefined }, {
//        get: (target, prop, self) => {
//            return (prop in target) ? target[prop] : (...args) => self;
//        },
//    });
//
//    let example = await p.myChainable().awaitable().method();
//
//    console.log("Result: ", example);
//})();


//const CDN = s => `https://cdnjs.cloudflare.com/ajax/libs/${s}`;
//const ramda = CDN('ramda/0.21.0/ramda.min');
//const jquery = CDN('jquery/3.0.0-rc1/jquery.min');
//requirejs.config({ paths: { ramda, jquery } });
//require(['jquery', 'ramda'], ($, { compose, curry, map, prop }) => {
//// -- Utils ----------------------------------------------------------
//const Impure = {
//trace: curry((tag, x) => { console.log(tag, x); return x; }), // eslint-disable-line no-console
//getJSON: curry((callback, url) => $.getJSON(url, callback)),
//setHtml: curry((sel, html) => $(sel).html(html)),
//};
//// -- Pure -----------------------------------------------------------
//const host = 'api.flickr.com';
//const path = '/services/feeds/photos_public.gne';
//const query = t => `?tags=${t}&format=json&jsoncallback=?`;
//const url = t => `https://${host}${path}${query(t)}`;
//const img = src => $('<img />', { src });
//const mediaUrl = compose(prop('m'), prop('media'));
//const mediaUrls = compose(map(mediaUrl), prop('items'));
//const images = compose(map(img), mediaUrls);
// -- Impure ---------------------------------------------------------
//const render = compose(Impure.setHtml('#js-main'), images);
//const app = compose(Impure.getJSON(render), url);
//const app = t => $.getJSON(
//  `https://${host}${path}${query(t)}`, 
//  o => Div(o.items.map(get(_1, ['media', 'm'])), Img(_1)).show()
//);
//app('capybara');
//});

</script>
  
  </body>
</html>
