<html>
  <head>
    <title>Tree input</title>
    <script src="../nice.js"></script>
  </head>
  <body style="margin:0;">
<script>
const { Div, H1, B, Box, RBox, BoxSet, clamp, Err } = nice;  


const c = Component('UserSnippet')
  .args({id:String})
  .input(args => {
    userInfo({id:args.id}): {
      name: String
      balance: Number
    }
  })
  .body((args, input) => {
    //input = {userInfo:{name:'Qwe', balance:12}}
    const {name, balance} = input.userInfo;
    return Div()
      .h3(name)
      .div('Balance: ', balance, '$');
  })
  .returnType(Div)

c.input = {
  userInfo: [type, args, children] // || [type, children] || [children]
}

c.input = {
  userInfo: ['User', {id:String}, {
    name: String,
    balance: Number
  }] // || [type, children] || [children]
}

c.input
  .userInfo({id:String})//assume Object
    .name.String
    .balance.Number
    .accaunts.Array//go down to item type
      .id.String
      .up
    .up
  .appStyle
    .defaultMargin.ofString

Component('getUserInfo')
  .args(id:String)
  .input((args, query) => query.fetchRecord({type:'User',id:args.id}).as('user'))
  .return.User
  .by((input, args) => {
    input.user
  });
    
query.add(getUserInfo)

////storage
const rows = {
  id: {field: value}
};
Action('addRecord')
  .args({fields:Object});
  
Action('updateRecord')
  .args({fields:Object, id: String});

Component('queryRows')
  .args({filter:Object})

/////chat
Component('messages')
  .return.ArrayOfString
  .action('add')
    .String('message')
    .by((oldState, message) => [...oldState, message]);
    
Component('messagesView')
  .input(i => i.messages.ArrayOfString)
  .by(input => {
    input.messages.map(message => Div(message))
  });
  
Component('chatView')
  .by(() => {
    return Div()
      .add(get(messagesView))
      .input().onValueEnter(value => messages.add(value))
  });


const input = {
  messages: Array
  settings: {
    style: {
      blockMargin: String
    }
  }
}


Component({
  input: {
    messages: Array
    settings: {
      style: {
        blockMargin: String.as('margin'),
        mainFontColor: String.as('color')
      }
    }
  },
  input
    .messages.Array
    .settings.style.blockMargin.as('margin').String,
  type: Div,
  by: ({messages, margin}) => {
    return Div(messages.map(m => Div('> ', m).margin(margin)));
  }
});


Component(
  $.messages.Array,      
  $.settings.style.blockMargin.String,
  $.settings.style.mainFontColor.String,
  Div,
  by: (messages, margin, color) => {
    return Div(messages.map(m => Div('> ', m).margin(margin)));
  }
});

Component(
  $.messages.Array,      
  $.settings.style.blockMargin.String.and.mainFontColor.String,
  Div,
  by: (messages, margin, color) => {
    return Div(messages.map(m => Div('> ', m).margin(margin)));
  }
});


  input
    .messages.Array
    .settings.style.Object
      .blockMargin.as('margin').String,
      .mainFontColor.as('color').String,
      
  messages: $.messages.Array,
  margin: $.settings.style.blockMargin.String,
  color: $.settings.style.mainFontColor.String    

  messages: $.messages.Array,
  $style: $.settings.style,        
  margin: $style.blockMargin.String,
  color: $style.mainFontColor.String    
  

  messages: Array,
  settings: {
    style: {
      blockMargin: String.as('margin'),
      mainFontColor: String.as('color')
    }
  }

  messages: $.messages.Array,
  style: $.settings.style(s => {
    margin: s.blockMargin.String
    color: s.mainFontColor.String
  })  
  
//no type query
q
  .messages()
  .settings
    .style
      .margin()
      .color()
      
 
  
///DB Schema
query
  row(id)
    property*
  rows([ids])
    property*          
  field(name)
    ??
  find(query)
    page(n, count)
      id
      property*
action
  setProperty(id, property, value)
      


</script>
  </body>
</html>
